/*! doc 2014-07-09 */
!function(){$.prompt=function(){var a,b=function(a){var b="alert-success";switch(a.type){case"info":b="alert-info";break;case"warning":b="alert-warning";break;case"danger":b="alert-danger"}return"<div><div class='alert "+b+" animate-enter'><strong>"+(a.title||"")+"</strong>"+a.content+"</div></div>"},c=[],d=0,e=[],f=2e3,g=3e3,h=function(){var j,k=c.length;if(j=c.shift(),k&&d++,j){var l=$(b(j));i.append(l),k&&setTimeout(function(){h()},f),e.push(setTimeout(function(){l.addClass("animate-leave"),setTimeout(function(){l.remove()},600),e.shift(),e.length||(a=setTimeout(function(){i.hide(),a=null},600))},g))}},i=$("<div class='prompt-box'></div>"),j=function(b){$(".prompt-box").length||$("body").append(i),c.length?c.push(b):(a?(clearTimeout(a),a=null):i.show(),c.push(b),h())};return j.clear=function(){for(c=[];e.length;)clearTimeout(e.unshift())},j}();var a=$('<div class="cm-tip hidden">');a.html('<div class="cm-tip-arrow"></div><div class="cm-tip-content"></div>'),$("body").append(a).on({mouseenter:function(){var b=$(this),c=b.data();a.removeClass("hidden"),a.find(".cm-tip-content").text(c.tip),"l"===c.alignment?($.fixed(b,a,{dir:"l"}),a.find(".cm-tip-arrow").addClass("cm-tip-arrow-left")):($.fixed(b,a),a.find(".cm-tip-arrow").removeClass("cm-tip-arrow-left"))},mouseleave:function(){a.addClass("hidden")}},"[data-tip]")}(),function(){$.fixed=function(a,b,c){var d=$(a),e=d[0].getBoundingClientRect(),f=$(b),g=6;switch(css={},opts={dir:"b",x:0,y:0},$.extend(opts,c),opts.dir){case"l":css={left:e.left-f.width()-g,top:e.top-f.height()/2+(e.bottom-e.top)/2};break;case"r":css={left:e.right+f.width()+g,top:e.top-f.height()/2+(e.bottom-e.top)/2};break;case"t":css={left:e.left-f.width()/2+(e.right-e.left)/2,top:e.top-g};break;default:css={left:e.left-f.width()/2+(e.right-e.left)/2,top:e.bottom+g}}css.left+=+opts.x||0,css.top+=+opts.y||0,f.css(css)}}(),function(){function a(a){var b=$("<span>");(a.wrap||a.loading||a.cover)&&(b.html(a.loading?a.loading:j),a.wrap&&a.cover?a.wrap.append(b):(a.wrap||$("body")).append(b=$('<div class="cover">').append(b)),a.$wrap=b,h[a.mark=++g]=b)}function b(a){a.mark in h&&(h[a.mark].remove(),delete h[a.mark])}function c(a){if(a.block){var b=a.url+"|"+a.method;if(b in i)return"string"==typeof a.block&&$.prompt({type:"warning",content:a.block}),!1;i[b]=a.block}}function d(a){if(a.block){var b=a.url+"|"+a.method;b in i&&delete i[b]}}function e(a){var b=a.$wrap,c='请求超时，<a href="javascript:;" class="reload">重试</a>';b&&(b.is(".cover")?b.children().html(c):b.html(c),b.find(".reload").data("opts",a).on("click",function(){var a=$(this).data("opts");return f(a),$.docsajax(a),!1}))}function f(a){var b=a.$wrap;b&&(a.$wrap=null,b.find(".reload").off().removeData("opts"),b.remove())}var g=0,h={},i={},j="加载中...";$.ajaxSetup({timeout:1e4}),$.docsajax=function(g){if(g.success&&(g._success=g.success,delete g.success),g.error&&(g._error=g.error,delete g.error),!g.block||c(g)!==!1){var h=$.ajax(g);a(g),h.then(function(a,c,e){var a=JSON.parse(a);f(g),b(g),d(g),a.error?(g.fail&&g.fail(a,e),$.prompt({type:"warning",content:$.map(a.errorMsg,function(a){return"<p>"+a+"</p>"})})):g._success&&g._success(a,e)}),h.error(function(a,c,h){401===a.status?location.href="/login":"timeout"===c?e(g):(0!==a.status||"error"!==c)&&(f(g),b(g),$.prompt({type:"danger",title:"错误：",content:h})),d(g),g._error&&g._error(arguments)})}}}(),function(){function a(a,b){this._defaultValidator={required:{msg:"请填写必填项",expression:'_ !==""'},number:{msg:"只能填写数字",expression:"$.isNumeric(_)"}},this.$el=a,this._validator={},this._init(b||{}),this._parseValidator()}function b(a){return function(b){var c={},d=this,e=[],b=b||{};return this.$el.find("input").each(function(f,g){var h,i=$(g),j=$.trim(i.val()),k=i.attr("name")||i.attr("id");return i.removeClass("error"),k&&("valid"!==a&&(c[k]=j),("valid"===a||b.valid)&&k in d._validator&&(h=d._validator[k](j,c),!h.pass&&(e.push(h),d._errorHandler(h),b.skip)))?!1:void 0}),"valid"===a?e:e.length?!1:c}}var c=/^(\/[\s\S]+\/)(?::|$)/;$.fn.inputBox=function(b,c){var d=$(this);return d.each(function(d,e){var f=$(e),g=f.data("inputBox");return g||(g=new a(f,b),f.data("inputBox",g)),result=g._handler(b,c),void 0!=result?!1:void 0}),void 0==result?d:result},a.prototype={constructor:a,_handler:function(a,b){if($.isPlainObject(a))for(var c in a)this[c]&&this[c](a[c]);else if("string"==typeof a&&"_"!==a[0]&&a in this)return this[a](b)},_init:function(a){$.isPlainObject(a.validator)&&$.extend(this._defaultValidator,a.validator)},_parseValidator:function(){var a=this.$el.find("input[data-validator]"),b=this;a.each(function(a,c){var d=$(c),e=d.data("validator").split(", "),f=d.attr("name")||d.attr("id"),g="";f&&$.each(e,function(a,c){g+=b._generateVlidator(c,f)}),g&&(g+=" return {pass:true};",b._validator[f]=new Function("_","_p",g))})},_generateVlidator:function(a,b){var d=this,e=a.split(":"),f=e[0],g=e[1],h="";return c.test(a)?(f=c.exec(a)[1],g=a.replace(f,"").slice(1),h+="if(!("+f+".test(_)))"):f in d._defaultValidator?(g||(g=d._defaultValidator[f].msg||""),f=d._defaultValidator[f].expression,h+=c.test(f)?"if(!("+f+".test(_)))":"if(!("+f+"))"):h+="if(!("+f+"))",h+='{ return {pass:false,field:"'+b+'",msg:"'+(g||"")+'"};}'},_errorHandler:function(a){var b=this.$el.find("[name="+a.field+"],[id="+a.field+"]").eq(0);b.addClass("error"),this._errorPrompt(a)},_errorPrompt:function(a){$.prompt({type:"warning",content:a.msg})},_submitBind:function(){var a=this;a.$el.off("keydown.inputBox"),a.$el.on("keydown.inputBox","input,textarea",function(b){if(13===b.keyCode){var c=$(this),d=a.$el.find("input:enabled,textarea:enabled");c.is(d.filter(":last"))?a._submitButton.click():d.eq(d.index(c)+1).focus()}})},button:function(a){this._submitButton="string"==typeof a?this.$el.find(a):a,this._submitBind()},focus:function(){this.$el.find("input:enabled:visible,textarea:enabled:visible").eq(0).focus()},clear:function(){this.$el.find("input,textarea").removeClass("error").val("")},destroy:function(){},errorHandler:function(a){$.isFunction(a)&&(this._errorPrompt=a)},valid:b("valid"),data:b("data")}}(),function(){function a(a,b){this.opts={title:"",button:[],onClose:$.noop,onOpen:$.noop,onDestory:$.noop},this.$el=a,this._init($.extend(this.opts,b))}function b(a){var b='<div class="cm-modal-box"><div class="cm-modal border"><div class="cm-modal-head"><h3>'+a.title+'</h3><span class="icon-close cm-modal-close"></span></div><div class="cm-modal-body"></div><div class="cm-modal-foot"></div></div></div>';return $(b)}$.fn.modal=function(b,c){var d=$(this);return d.each(function(d,e){var f=$(e),g=f.data("modal");return g||(g=new a(f,b),f.data("modal",g)),result=g._handler(b,c),void 0!=result?!1:void 0}),void 0==result?d:result},a.prototype={constructor:a,_handler:function(a,b){if($.isPlainObject(a))for(var c in a)this[c]&&this[c](a[c]);else if("string"==typeof a&&"_"!==a[0]&&a in this)return this[a](b)},_init:function(a){var c=b(a),d=this;this.$modal=c,c.find(".cm-modal-body").append(this.$el.show()),c.on("click",".cm-modal-close",function(){d.close()}).on("mousedown",function(a){this===a.target&&d.close()}),c.find(".cm-modal-foot").html($.map(a.button.length?a.button:[{text:"取消",className:"cm-modal-close"}],function(a){var b=a.type?"btn-"+a.type:"btn-default",c=a.className||"",d=$('<button class="btn '+b+" "+c+'">'+a.text+"</button>");return a.click&&d.click(a.click),d})),$("body").append(c)},type:function(a){this.$modal.find(".cm-modal-head").removeClass("bg-success bg-info bg-warning bg-danger").addClass("bg-"+a)},destroy:function(){this.$el.removeData("modal"),this.$modal.remove(),this.opts.onDestory()},open:function(){var a=this;this.$modal.fadeIn().find(".cm-modal").animate({top:0},"swing",function(){a.opts.onOpen()}),$("html,body").addClass("cm-modal-overflow-hidden")},close:function(){var a=this;this.$modal.fadeOut().find(".cm-modal").animate({top:"-100%"},"swing",function(){a.opts.onClose(),$("html,body").removeClass("cm-modal-overflow-hidden")})},width:function(a){this.$modal.find(".cm-modal").css("width",a)},height:function(a){this.$modal.find(".cm-modal").css("height",a),this.$modal.find(".cm-modal-body").css("height",a-97)}}}(),function(){$.msg=function(a){var b=$("<p>"),c={width:450,type:"info",title:"提示",button:[{text:"关闭",click:function(){b.modal("close")}}],onClose:function(){b.modal("destroy")}};if($.isPlainObject(a)){switch(a.type){case"warning":case"alert":$.extend(c,{type:"warning"});break;case"danger":case"confirm":$.extend(c,{button:[{text:"确定",type:"danger"===a.type?"danger":"primary",click:function(){a.ok&&a.ok(),b.modal("close")}},{text:"取消",click:function(){b.modal("close")}}]},"danger"===a.type?{type:"danger",title:"警告"}:{type:"info",title:"确认"});break;case"success":$.extend(c,{type:"success"})}a.title&&(c.title=a.title),b.html(a.msg).modal(c),b.modal("open")}else"string"==typeof a&&(b.html(a).modal(c),b.modal("open"))}}();